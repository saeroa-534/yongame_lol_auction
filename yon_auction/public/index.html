<!DOCTYPE html>
<html lang="ko">
    <head>
        <meta charset="utf-8" />   
        <!-- 모바일에서 화면 폭을 기기 폭에 맞추고, 초기 확대 비율을 1로 설정 -->
        <meta name="viewport" content="width=device-width,initial-scale=1" />
        <title>연낳대 시즌6 경매 시스템</title>
    </head>
    <body>
        <h1> 연낳대 시즌6 경매 시스템 제목</h1>
        <!--
            id는 나중에 js에서 document.querySelector()를 통해 요소를 찾기 위해 붙임
            placeholder는 입력란에 희미하게 표시되는 안내 문구
         -->
        <input id="name" placeholder="이름">
        <input id="price" type="number" placeholder="입찰가">
        <button id =btn></button>

        <!-- pre는 preformatted text의 약자로, 줄바꿈/공백이 그대로 유지. 여기서는 로그표시용으로 사용됨 -->
        <pre id="log"></pre>

        <!-- 서버에서 Socket.io를 켜면 자동으로 제공되는 클라이언트 스크립트 -->
        <!-- 브라우저가 이 경로로 요청하면 Socket.io가 js파일을 제공 -->
        <script src="/socket.io/socket.io.js"></script>

        <!-- 메인 스크립트 -->
        <script>
            const socket = io(); // 방금 로드한 socket.io를 연결시도

            const log = document.querySelector("#log"); // 로그 표시용 <pre> 요소

            // 로그를 위로 쌓는 함수
            function addLine(line) {
                log.textContent = line + "\n" + log.textContent;
            }
            
            document.querySelector('#btn').addEventListener('click', () => {
                const name = document.querySelector('#name').value || '익명';   // 입력값이 없으면 '익명'으로 처리
                const price = Number(document.querySelector('#price').value || 0);  // 입력값이 없으면 0으로 처리
                socket.emit("bid", {name, price});  // 'bid' 이벤트를 서버로 전송
            });

            // 서버가 io.emit("bid", data)로 뿌린 이벤트를 수신
            // JSON.stringify(data)는 data 객체를 JSON 문자열로 변환
            socket.on("bid", (data) => addLine(JSON.stringify(data)));
        </script>

    </body>
</html>


<!--
<!doctype html>
<html lang="ko">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width,initial-scale=1" />
    <title>연낳대 경매 테스트</title>
  </head>
  <body>
    <h1>연낳대 경매 테스트</h1>

    <input id="name" placeholder="이름" />
    <input id="price" type="number" placeholder="입찰가" />
    <button id="btn">입찰</button>

    <pre id="log"></pre>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();
      const log = document.querySelector("#log");

      function addLine(line) {
        log.textContent = line + "\n" + log.textContent;
      }

      document.querySelector("#btn").addEventListener("click", () => {
        const name = document.querySelector("#name").value || "익명";
        const price = Number(document.querySelector("#price").value || 0);
        socket.emit("bid", { name, price });
      });

      socket.on("bid", (data) => addLine(JSON.stringify(data)));
    </script>
  </body>
</html>

-->

